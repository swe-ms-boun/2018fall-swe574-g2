<!--
This is your default homepage.
For more information, see:
• https://sailsjs.com/documentation/concepts/views
• https://sailsjs.com/documentation/concepts/routes
-->

<style>
img.thumbnail {
  width:64px; 
  height: auto;
}
</style>

<div class="jumbotron">
  <center><h1>Thymesis</h1></center>
  <br>
  <% posts.forEach((memory) => { %>
    <div class="card border-primary mb-3">
    <div class="card-header">
      <a href="/memory/<%=memory.post_id%>"><h4><%= memory.title %></h4></a>
    </div>
    <div class="card-body">
    <div class="row">
      <div class="col-1">
      <% if (memory.image_url === 'none') { %>
      <img class="thumbnail" src="/images/no-image.png" />
      <%} else {%>
      <img class="thumbnail" src="<%=memory.image_url%>" />
      <%}%>
      </div>
      <div class="col-11">
      <p class="card-text"><%= memory.summary %></p>
      </div>
    </div>
    </div>
      <div class="card-footer text-muted">
      created <%= memory.datetime %> by <a href="/userpage/<%=memory.user%>"><span id="<%=memory.post_id%>" class="badge badge-primary badge-pill"></span></a> from <a href="https://www.google.com/maps/place/<%= memory.location.replace(':',',')%>">this location.</a>
    </div>
  </div>
  <% }) %>

</div>

<script src="/optionaljs/axios.js"></script>

<script>

<% posts.forEach((memory) => { %>
  axios.get('https://thymesis-memories-v3.herokuapp.com/api/Users/<%=memory.user%>').then((response) => {
    document.getElementById('<%=memory.post_id%>').innerText = response.data.username;
  })
<% }) %>

</script>
